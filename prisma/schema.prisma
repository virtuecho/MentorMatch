generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int                @id @default(autoincrement())
  email             String             @unique
  isMentorApproved  Boolean            @default(true)
  createdAt         DateTime           @default(now())
  passwordHash      String
  updatedAt         DateTime           @default(now())
  role              Role               @default(mentee)
  availabilitySlots AvailabilitySlot[]
  menteeBookings    Booking[]          @relation("MenteeBookings")
  mentorBookings    Booking[]          @relation("MentorBookings")
  mentorRequests    MentorRequest[]
  mentorSkills      MentorSkill[]
  notifications     Notification[]
  profile           UserProfile?
}

model UserProfile {
  userId          Int     @id
  fullName        String
  bio             String?
  location        String?
  profileImageUrl String?
  linkedinUrl     String?
  websiteUrl      String?
  user            User    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model MentorRequest {
  id          Int           @id @default(autoincrement())
  documentUrl String
  reviewedAt  DateTime?
  submittedAt DateTime      @default(now())
  userId      Int
  status      RequestStatus @default(pending)
  user        User          @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model MentorSkill {
  id        Int    @id @default(autoincrement())
  mentorId  Int
  skillName String
  mentor    User   @relation(fields: [mentorId], references: [id], onDelete: Cascade)
}

model AvailabilitySlot {
  id        Int       @id @default(autoincrement())
  mentorId  Int
  startTime DateTime
  endTime   DateTime
  isBooked  Boolean   @default(false)
  mentor    User      @relation(fields: [mentorId], references: [id], onDelete: Cascade)
  booking   Booking[]
}

model Booking {
  id                 Int               @id @default(autoincrement())
  topic              String
  availabilitySlotId Int?
  createdAt          DateTime          @default(now())
  locationDetails    String?
  locationType       LocationType
  menteeId           Int
  mentorId           Int
  status             BookingStatus     @default(pending)
  availabilitySlot   AvailabilitySlot? @relation(fields: [availabilitySlotId], references: [id])
  mentee             User              @relation("MenteeBookings", fields: [menteeId], references: [id], onDelete: Cascade)
  mentor             User              @relation("MentorBookings", fields: [mentorId], references: [id], onDelete: Cascade)
}

model Notification {
  id        Int      @id @default(autoincrement())
  userId    Int
  message   String
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

enum Role {
  mentee
  mentor
}

enum RequestStatus {
  pending
  approved
  rejected
}

enum BookingStatus {
  pending
  confirmed
  rejected
  cancelled
}

enum LocationType {
  online
  in_person
}
