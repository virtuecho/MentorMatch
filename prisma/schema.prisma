generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int                @id @default(autoincrement())
  email             String             @unique
  isMentorApproved  Boolean            @default(true)
  createdAt         DateTime           @default(now())
  passwordHash      String
  updatedAt         DateTime           @default(now())
  role              Role               @default(mentee)
  availabilitySlots AvailabilitySlot[]
  menteeBookings    Booking[]          @relation("MenteeBookings")
  mentorBookings    Booking[]          @relation("MentorBookings")
  mentorRequests    MentorRequest[]
  mentorSkills      MentorSkill[]
  notifications     Notification[]
  profile           UserProfile?
}

model UserProfile {
  userId            Int     @id
  fullName          String
  bio               String?
  location          String?
  profileImageUrl   String?
  linkedinUrl       String?
  websiteUrl        String?
  phone             String?
  socialMedia       String?

  // Education
  educations        Education[]

  //Experience
  experience        Experience[]

  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId            Int     @id
  fullName          String
  bio               String?
  location          String?
  profileImageUrl   String?
  linkedinUrl       String?
  websiteUrl        String?
  phone             String?
  socialMedia       String?

  // Education
  educations        Education[]

  //Experience
  experience        Experience[]

  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model MentorRequest {
  id          Int           @id @default(autoincrement())
  documentUrl String
  reviewedAt  DateTime?
  submittedAt DateTime      @default(now())
  userId      Int
  status      RequestStatus @default(pending)
  user        User          @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model MentorSkill {
  id          Int           @id @default(autoincrement())
  mentorId    Int
  skillName   String
  skillLevel  SkillLevel?   // Look up SkillLevel model for options
  mentor      User          @relation(fields: [mentorId], references: [id], onDelete: Cascade)
  id          Int           @id @default(autoincrement())
  mentorId    Int
  skillName   String
  skillLevel  SkillLevel?   // Look up SkillLevel model for options
  mentor      User          @relation(fields: [mentorId], references: [id], onDelete: Cascade)
}

model AvailabilitySlot {
  id              Int           @id @default(autoincrement())
  mentorId        Int
  title           String?
  startTime       DateTime
  durationMins    Int
  locationType    LocationType  @default(in_person)
  city            String
  address         String
  maxParticipants Int           @default(2)
  note            String?
  isBooked        Boolean       @default(false)
  mentor          User          @relation(fields: [mentorId], references: [id], onDelete: Cascade)
  booking         Booking[]
  id              Int           @id @default(autoincrement())
  mentorId        Int
  title           String?
  startTime       DateTime
  durationMins    Int
  locationType    LocationType  @default(in_person)
  city            String
  address         String
  maxParticipants Int           @default(2)
  note            String?
  isBooked        Boolean       @default(false)
  mentor          User          @relation(fields: [mentorId], references: [id], onDelete: Cascade)
  booking         Booking[]
}

model Booking {
  id                 Int               @id @default(autoincrement())
  topic              String
  description        String?
  availabilitySlotId Int
  description        String?
  availabilitySlotId Int
  createdAt          DateTime          @default(now())
  updatedAt          DateTime          @default(now())
  numParticipants    Int               @default(1)
  note               String?
  updatedAt          DateTime          @default(now())
  numParticipants    Int               @default(1)
  note               String?
  menteeId           Int
  mentorId           Int
  status             BookingStatus     @default(pending)
  availabilitySlot   AvailabilitySlot? @relation(fields: [availabilitySlotId], references: [id])
  mentee             User              @relation("MenteeBookings", fields: [menteeId], references: [id], onDelete: Cascade)
  mentor             User              @relation("MentorBookings", fields: [mentorId], references: [id], onDelete: Cascade)
}

model Education {
  id          Int           @id @default(autoincrement())
  userId      Int
  university  String
  degree      String
  major       String
  startYear   Int
  endYear     Int?
  status      Status        @default(on_going)
  logoUrl     String?
  description String?
  userProfile UserProfile   @relation(fields: [userId], references: [userId], onDelete: Cascade)
}

model Experience {
  id          Int           @id @default(autoincrement())
  userId      Int
  company     String
  position    String
  industry    String?
  expertise   String?       // Stored as JSON string
  startYear   Int
  endYear     Int?
  status      Status        @default(on_going)
  description String?
  userProfile UserProfile   @relation(fields: [userId], references: [userId], onDelete: Cascade)

}

model Education {
  id          Int           @id @default(autoincrement())
  userId      Int
  university  String
  degree      String
  major       String
  startYear   Int
  endYear     Int?
  status      Status        @default(on_going)
  logoUrl     String?
  description String?
  userProfile UserProfile   @relation(fields: [userId], references: [userId], onDelete: Cascade)
}

model Experience {
  id          Int           @id @default(autoincrement())
  userId      Int
  company     String
  position    String
  industry    String?
  expertise   String?       // Stored as JSON string
  startYear   Int
  endYear     Int?
  status      Status        @default(on_going)
  description String?
  userProfile UserProfile   @relation(fields: [userId], references: [userId], onDelete: Cascade)

}

model Notification {
  id        Int      @id @default(autoincrement())
  userId    Int
  title     String   // "No title" if no title provided
  title     String   // "No title" if no title provided
  message   String
  type      NotificationType    // Look up NotificationType for options
  type      NotificationType    // Look up NotificationType for options
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

enum Role {
  mentee
  mentor
  admin
}

enum Status {
  completed
  on_going
  admin
}

enum Status {
  completed
  on_going
}

enum RequestStatus {
  pending
  approved
  rejected
}

enum BookingStatus {
  pending
  accepted
  accepted
  rejected
  cancelled
  completed
  completed
}

enum LocationType {
  online
  in_person
}

enum SkillLevel {
  beginner
  intermediate
  advanced
  expert
}

enum NotificationType {
  booking
  verification
  system
  reminder
}